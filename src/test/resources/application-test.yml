spring:
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
    clean-disabled: false  # allow clean if needed during tests
    clean-on-validation-error: true
    # âœ… This breaks the circular dependency by running Flyway before Hibernate
    url: jdbc:postgresql://localhost/testdb
    user: postgres
    password: postgres


  datasource:
    url: jdbc:postgresql://localhost/testdb
    username: postgres
    password: postgres
    driver-class-name: org.postgresql.Driver

  jpa:
    hibernate:
      ddl-auto: none   # âœ… Hibernate should NOT modify schema; Flyway owns it
      show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect

  test:
    database:
      replace: none   # âœ… Do not replace with in-memory DB

  sql:
    init:
      mode: never     # ðŸš« Disable old schema/data scripts (schema_old.sql)

logging:
  level:
    org.hibernate.SQL: debug
    org.flywaydb: info

